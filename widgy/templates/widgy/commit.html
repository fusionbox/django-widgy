{% extends "widgy/popup_base.html" %}
{% load url from future %}
{% load i18n %}

{% block content %}
  <h2>{% trans "Commit Changes" %}</h2>
  {% if changed_anything %}
    <form method="post" class="commit_form" action="{{ commit_url }}">
      {% csrf_token %}
      {% for field in form %}
        {% include "widgy/field_as_div.html" %}
      {% endfor %}
      
      <p class="submitRow">
        <input type="submit" value="{% trans 'Commit' %}">
      {# TODO: this is dependent on widgy_mezzanine #}
        <a class="button" target="_blank" href="{% url 'widgy.contrib.widgy_mezzanine.views.preview' node_pk=object.working_copy.pk %}">{% trans "Preview" %}</a>
      {% if diff_url %}
        <a class="button" target="_blank" href="{{ diff_url }}">{% trans "Diff" %}</a>
      {% endif %}
      </p>
    </form>
  {% else %}
    <p>{% trans "Nothing has changed -- no need to commit." %}</p>
  {% endif %}
{% endblock %}
