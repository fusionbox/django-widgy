{% load i18n %}
{% load url from future %}
<form method="post" class="commit_form" action="{{ action_url }}">
  {% csrf_token %}
  {{ form.media }}

  {% include "widgy/field_as_div.html" with field=form.message %}

  <div class="publish_at formField">
    {{ form.publish_at.label_tag }}
    {{ form.publish_radio }}

    <div class="publish_at_container">
      {{ form.publish_at }}
      {{ form.publish_at.errors }}
    </div>

    {% if form.publish_at.help_text %}
      <p class="help_text">{{ form.publish_at.help_text }}</p>
    {% endif %}
  </div>

  <p class="submitRow">
    {% block submit_row %}
      <input type="submit" value="{% trans 'Commit' %}">
      {# TODO: this is dependent on widgy_mezzanine #}
      <a class="button" target="_blank" href="{% url 'widgy.contrib.widgy_mezzanine.views.preview' node_pk=commit.pk %}">{% trans "Preview" %}</a>
      {% if diff_url %}
        <a class="button" target="_blank" href="{{ diff_url }}">{% trans "Diff" %}</a>
      {% endif %}
    {% endblock %}
  </p>
</form>
